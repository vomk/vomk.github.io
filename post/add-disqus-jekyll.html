<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />


	<title>Добавление Disqus в Jekyll</title>


<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@vladik_omk" />
<meta name="twitter:title" content="Добавление Disqus в Jekyll" />
<meta name="twitter:description" content="Статья о том, как добавить комментирование в Jekyll с помощью сервиса Disqus">

<meta name="description" content="Блог про книги, историю, компьютерные технологии, собственные мысли, обозрение новостей, критика и многое другое, с моей головы Статья о том, как добавить комментирование в Jekyll с помощью сервиса Disqus">

<link rel="author" href="https://plus.google.com/u/0/103459417251313685406"/>

<link rel="icon" href="/assets/favicon.png">
<link rel="apple-touch-icon" href="/assets/touch-icon.png">
<link rel="stylesheet" href="/assets/core.css">
<link rel="canonical" href="/post/add-disqus-jekyll">
<link rel="alternate" type="application/atom+xml" title="VOMK Блог" href="/feed.xml" />





<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
	</head>

	<body>

		<aside class="logo">

	

	<a href="/">
		<img src="http://www.gravatar.com/avatar/ae0c7f1c34df533e6fc75514185564ca.png?s=80" alt="ВОМК Логотип" class="gravatar">
	</a>
	<span class="logo-prompt">На главную</span>

</aside>


		<main>
			<article>

	<div class="center">
		<h1>Добавление Disqus в Jekyll</h1>
		<time>September 28, 2017</time>
	</div>

	<div class="divider"></div>

	<p>Блог Jekyll не поддерживает базы данных. Люди не могут комментировать или обсуждать сообщения в блогах. Disqus - это сторонняя служба, которая может использоваться для снятия этого ограничения.</p>

<h3 id="инструкция">Инструкция</h3>

<p>Сначала установите Jekyll и зарегистрируйте свой сайт на <a href="https://disqus.com/admin/create/">Disqus</a>.</p>

<p>Добавьте следующий код в <strong>_includes/disqus.html</strong>. Не забудьте изменить строку <strong>this.page.url</strong> на URL вашего блога. Строка <strong>s.src</strong> должна указывать на ваш короткий URL-адрес Disqus.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% if page.comments %}
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"disqus_thread"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">disqus_config</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="k">this</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s2">"http://ВАШАДРЕС{{ page.url }}"</span><span class="p">;</span> <span class="c1">// </span><span class="o">&lt;---</span> <span class="err">здесь</span> <span class="err">ваш</span> <span class="nx">url</span>
<span class="k">this</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">identifier</span> <span class="o">=</span> <span class="s2">"{{ page.id }}"</span><span class="p">;</span>
<span class="p">};</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nb">document</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'script'</span><span class="p">);</span>

<span class="nx">s</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">'//ИМЯНАDISQUS.disqus.com/embed.js'</span><span class="p">;</span> <span class="c1">// </span><span class="o">&lt;---</span> <span class="err">ваше</span> <span class="err">имя</span> <span class="err">на</span> <span class="nx">disqus</span>

<span class="nx">s</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">'data-timestamp'</span><span class="p">,</span> <span class="o">+</span><span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
<span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">head</span> <span class="o">||</span> <span class="nx">d</span><span class="p">.</span><span class="nx">body</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;noscript&gt;</span>Пожалуйста, включите работу JavaScript, что бы заработало <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://disqus.com/?ref_noscript"</span> <span class="na">rel=</span><span class="s">"nofollow"</span><span class="nt">&gt;</span>комментирование с сервиса Disqus.<span class="nt">&lt;/a&gt;&lt;/noscript&gt;</span>
{% endif %}
</code></pre></div></div>

<p>Добавьте следующую строку в конец <strong>_layouts/post.html</strong> или в другое место, где вы хотите отображать комментарии.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% include disqus.html %}
</code></pre></div></div>

<p>Добавьте следующую строку к параметрам MD-страницы, чтобы разрешить комментарии на странице.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>comments: true
</code></pre></div></div>

<p>Например, параметры этого поста выглядят так.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
title: Добавление Disqus в Jekyll
update: 2017-09-28 11:26
descript: Статья о том, как добавить комментирование в Jekyll с помощью сервиса Disqus
comments: true
---
</code></pre></div></div>

<p>При желании, чтобы улучшить отображение комментариев, добавьте следующее в <strong>_layouts/default.html</strong> перед закрывающим тегом <strong>&lt;/body&gt;</strong>. Измените ВАШЕИМЯDISQUS на ваше имя Disqus.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"dsq-count-scr"</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"//ВАШЕИМЯDISQUS.disqus.com/count.js"</span> <span class="k">async</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<p>Добавьте <strong>#disqus_thread</strong> в конец URL-адреса, и Disqus посчитает комментарии на странице, на которую указывает ссылка. Например, мой <strong>_layouts/post.html</strong> содержит следующий код. Обратите внимание на количество комментариев в верхней части этого поста.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% if page.comments %} • <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://ВАШАДРЕС{{ page.url }}#disqus_thread"</span><span class="nt">&gt;</span>0 комментариев<span class="nt">&lt;/a&gt;</span>{% endif %}
</code></pre></div></div>

<p><strong>index.html</strong> содержит следующий код для отображения количества комментариев для каждого поста в списке.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://ВАШАДРЕС{{ post.url }}#disqus_thread"</span><span class="nt">&gt;</span>(0)<span class="nt">&lt;/a&gt;</span>
</code></pre></div></div>

<p>Обратите внимание, что перемещение поста из <strong>_drafts/</strong> в <strong>_posts/</strong> может изменить URL-адрес страницы поста. Это приведет к исчезновению комментариев, добавленных в черновик. Инструменты миграции Disqus можно использовать для перемещения комментариев к новому URL-адресу.</p>

<p><a href="http://sgeos.github.io/jekyll/disqus/2016/02/14/adding-disqus-to-a-jekyll-blog.html">Источник статьи</a></p>


</article>


<div id="disqus_thread" class="comment-block"></div>
<script>
var disqus_config = function () {
this.page.url = "http://вомк.name/post/add-disqus-jekyll"; // <--- здесь ваш url
this.page.identifier = "/post/add-disqus-jekyll";
};
(function() {
var d = document, s = d.createElement('script');

s.src = '//vomk.disqus.com/embed.js'; // <--- ваше имя на disqus

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Пожалуйста, включите работу JavaScript, что бы заработало <a href="https://disqus.com/?ref_noscript" rel="nofollow">комментирование с сервиса Disqus.</a></noscript>


<div class="page-navigation">
	
    <a class="next" href="/post/jekyll-seo" title="Следующая: SEO для вашего блога на Jekyll">&lt;&lt; Предыдущий пост</a>
		<span> &middot; </span>
  
		<a class="home" href="/" title="На главную">Главная</a>
  
		<span> &middot; </span>
    <a class="prev" href="/post/first-post" title="Предыдущая: Буковски - мой душевный герой">Следующий пост &gt;&gt;</a>
  
</div>

		</main>

		<div class="footer">
  <span class="block">&copy; 2017 Vladik ОМК</span>
  <ul class="soc-links">
    
      <li>
        <a href="https://www.instagram.com/vladik.omk">
          <i class="fa fa-instagram"></i> Instagram
        </a>
      </li>
    
    
      <li>
        <a href="https://twitter.com/vladik_omk">
          <i class="fa fa-twitter"></i> Twitter
        </a>
      </li>
    
    
      <li>
        <a href="https://github.com/vomk">
          <i class="fa fa-github"></i> GitHub
        </a>
      </li>
    
    
      <li>
        <a href="https://plus.google.com/103459417251313685406">
          <i class="fa fa-google-plus"></i> Google+
        </a>
      </li>
    
    
    
      <li>
        <a href="https://www.facebook.com/vlad.omelchuck.5">
          <i class="fa fa-facebook"></i> Facebook
        </a>
      </li>
    
    
  </ul>
  <span class="block">Powered by <a href="https://jekyllrb.com/" alt="Jekyll" title="Official site Jekyll">Jekyll</a></span>
  <!--bigmir)net TOP 100-->
  <script type="text/javascript" language="javascript">
  function BM_Draw(oBM_STAT){
  document.write('<table cellpadding="0" cellspacing="0" border="0" style="display:inline;margin-right:4px;"><tr><td><div style="font-family:Tahoma;font-size:10px;padding:0px;margin:0px;"><div style="width:7px;float:left;background:url(\'//i.bigmir.net/cnt/samples/default/b54_left.gif\');height:17px;padding-top:2px;background-repeat:no-repeat;"></div><div style="float:left;background:url(\'//i.bigmir.net/cnt/samples/default/b54_center.gif\');text-align:left;height:17px;padding-top:2px;background-repeat:repeat-x;"><a href="http://www.bigmir.net/" target="_blank" style="color:#0000ab;text-decoration:none;">bigmir<span style="color:#ff0000;">)</span>net</a>  <span style="color:#98b4f4;">хиты</span> <span style="color:#426ed2;font:10px Tahoma;">'+oBM_STAT.hits+'</span> <span style="color:#98b4f4;">хосты</span> <span style="color:#426ed2;font:10px Tahoma;">'+oBM_STAT.hosts+'</span></div><div style="width:7px;float: left;background:url(\'//i.bigmir.net/cnt/samples/default/b54_right.gif\');height:17px;padding-top:2px;background-repeat:no-repeat;"></div></div></td></tr></table>');
  }
  </script>
  <script type="text/javascript" language="javascript">
  bmN=navigator,bmD=document,bmD.cookie='b=b',i=0,bs=[],bm={o:1,v:16951500,s:16951500,t:0,c:bmD.cookie?1:0,n:Math.round((Math.random()* 1000000)),w:0};
  for(var f=self;f!=f.parent;f=f.parent)bm.w++;
  try{if(bmN.plugins&&bmN.mimeTypes.length&&(x=bmN.plugins['Shockwave Flash']))bm.m=parseInt(x.description.replace(/([a-zA-Z]|\s)+/,''));
  else for(var f=3;f<20;f++)if(eval('new ActiveXObject("ShockwaveFlash.ShockwaveFlash.'+f+'")'))bm.m=f}catch(e){;}
  try{bm.y=bmN.javaEnabled()?1:0}catch(e){;}
  try{bmS=screen;bm.v^=bm.d=bmS.colorDepth||bmS.pixelDepth;bm.v^=bm.r=bmS.width}catch(e){;}
  r=bmD.referrer.replace(/^w+:\/\//,'');if(r&&r.split('/')[0]!=window.location.host){bm.f=escape(r).slice(0,400);bm.v^=r.length}
  bm.v^=window.location.href.length;for(var x in bm) if(/^[ovstcnwmydrf]$/.test(x)) bs[i++]=x+bm[x];
  bmD.write('<sc'+'ript type="text/javascript" language="javascript" src="//c.bigmir.net/?'+bs.join('&')+'"></sc'+'ript>');
  </script>
  <noscript>
  <a href="http://www.bigmir.net/" target="_blank"><img src="//c.bigmir.net/?v16951500&s16951500&t2" width="88" height="31" alt="bigmir)net TOP 100" title="bigmir)net TOP 100" border="0" /></a>
  </noscript>
  <!--bigmir)net TOP 100-->
</div>

	</body>

</html>
